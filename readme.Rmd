---
title: "Micromobility in Austin, Texas"
output: html_document
date: "2023-10-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Short Project Description
This project aims to investigate the relationships and correlations between trip duration or trip distance in micromobility vehicles (e.g., electric scooters or bikes) and various factors in Austin, Texas. The variables of interest include year, month, day of the week, hour of the day, temperature, wind speed, and precipitation, Council District Start, Council District End, and Council District Street Condition Percent Satisfactory.

# Goals
Identify correlations and trends between variables to help urban planners, companies such as Lime, and policymakers make better informed decisions about micromobility infrastructure and services in the area. The findings from this project may also contribute to improving the usability and accessibility of micromobility options for people in Austin.

# Link to The Data
<https://data.austintexas.gov/Transportation-and-Mobility/Shared-Micromobility-Vehicle-Trips/7d8e-dm7r>

# Some Information About The Data: 
This dataset contains shared micromobility vehicle trip data from 1970 to 2022 reported to the City of Austin Transportation Department as part of the Shared Small Vehicle Mobility Systems operating rules. The trips included in this dataset have durations less than 24 hours and have trip distances greater than or equal to 0.1 miles and less than 500 miles. Additional weather data and data on 'Council District Street Condition Percent Satisfactory' will be merged with the original micromobility vehicle trip data linked above. This additional data will be considered to analyze the potential effects of these variables, which were not originally included in the shared micromobility vehicle trip data.

# Hypotheses:
1. The mean trip distances for micromobility vehicles are not equal across different months of the year in 2020.
2. The mean trip distances for micromobility vehicles are not equal across different days of the week in 2020.
3. The mean trip distances and trip durations are not equal across different vehicle types.

# Ethical Concerns:
1. Environmental Impact: research into micromobility vehicles may increase/encourage more usage of vehicles that are negatively impacting our environment.
2. Consent: researchers should try to get consent of those who make up the data (i.e., the drivers, or those reporting on the quality of infrastructure).

# RRI AREA analysis:
Anticipate Opportunities:

Process- the methodology seems to be allowed since the data is given access to the public, as well as in a confined space. Product - the product is socially desirable since it contains enough information about the statistics pertaining to different vehicles, as well as distances and time, and still keeping each individual private
Product - the product is socially desirable since it contains enough information about the statistics pertaining to different vehicles, as well as distances and time, and still keeping each individual private
Purpose - the research on micro mobility can have impacts socially by providing the information of different times of the year, which can be used for or against micro mobility. Furthermore, many can see if the pros outweigh the cons for allowing many to travel with micro mobility devices more and vice versa, it just depends on what the goal is.
People - the targeted stakeholders range from the public to the government, meaning that if the public was given knowledge about this, there could be different planning taken into place to travel less on micro mobility devices. For the government, this could allow different adjustments to policies made on public transportation that could have students use less micro mobility transportation for safety reasons, or even the opposite on where the government makes more lanes to encourage micro mobility more.

Reflect considerations:

Process - some mechanisms that are appropriate to look into are the descriptive statistics that need to be included, which does show within the project such as: trip distance, satisfactory levels of street conditions, and other specific variables that deal with the environment. Furthermore, another mechanism is the correlation between different variables and how they connect to each other.
Product - looking at the consequences, there are both positives and negatives. The positives is that it can improve public safety if understanding the different patterns on environmental changes, as well as creating a much more efficient infrastructure within Austin. The negatives however, could be that there can be different privacy issues that could be shared without consent, as well as discrimination/bias concerns. To take care of these issues, inform the users to get their consent on what the data is going to be used for, and to state whether there is going to be biases or not.
Purpose - this could raise concerns by different groups or organizations that deals with anything that involves surveillance or privacy that could infringe on an individualsâ€™ rights/freedoms, which to help ensure these groups that there will be no problems, there needs to be clear communication towards the stakeholders, and to have them understand the process and allow different feedbacks/comments on the project.
People - the project is inclusive to all types of people, going from every gender to every culture and race. The only problem is that this will only include people who use the micro mobility devices that are listed: bicycles, scooters, and electric scooters and moped.

Engage Alternatives:

Process - to engage a big group of stakeholders, there should be an identification on who the stakeholders are, which ranges from any member in the community, to with different public organizations and even the government. After that, focus on what will interest these stakeholders and what all of them have in common, which after that you will develop a message that is aimed towards everyone.
Product - Targeting some viewpoints of the stakeholders above, we will look at each individually. The Community their viewpoints would target something along the lines of safety of traveling as well as the convenience of it, government would look into the public interest that looks at infrastructure as well as safety, and different public groups would look into the environmental impacts of these projects as well as having the community involved with micro mobility.
Purpose - to get people involved with the work surrounding the project, there should be different methods to reach the public, such as: creating different websites, or social media to spread public awareness, setting up meetings for people who want to attend, or handing out surveys for the community to give feedback.
People - The research is done for people who will use the data for environmental reasons (researchers and non-profit organizations),reasons pertaining to public safety (government and community groups), and even reasons to have more efficient infrastructure (industrial companies)

Act Capacities:

Process - Our research structure could be flexible by having different factors such as allowing a clearer research goal that is very assessable and well-defined. Furthermore, there should always be continuous feedback being given and adapting to those changes would allow a much more structured plan for the project.
Product - to have social desirability for everyone, there should be methods that should eliminate any biases towards a certain group, and to do that there should be anonymous responses given in a way that still allows the user to access their data to make any changes. Furthermore, there should be clear consent clauses and information that is transparent, which ensures the user that their data will be safe.
Purpose - to ensure a better future with this project, we can create policies that give off a positive outcome to micro mobility around Austin, as well as addressing any ethical concerns that the public may have on the situation by giving concise and straightforward messages . Furthermore, careful planning can help ensure a better future with this project in the works by providing potential risks and acting against it or even having clear timelines on when the project reaches a certain checkpoint.
People - The training that is required for the project is some, but not all: data collection/security, ethical researching, statistical analysis, etc.

# References:
Data is provided by Austin Transportation and The City of Austin, Texas at <https://data.austintexas.gov>
Weather data is provided by <https://www.weather.gov/wrh/Climate?wfo=ewx>
Council District Street Condition Percent Satisfactory data is provided by <https://data.austintexas.gov/City-Infrastructure/Street-Conditions-by-Council-District-DRAFT/un9d-25i8>

# Visualizations:
```{r}
library(ggplot2)
library(dplyr)

# Data from original micromobility dataset for the year 2020
y2020 <- read.csv('Trips2020.csv')

# Create a new column 'Month2' by recoding the 'Month' column with an ordered factor.
y2020 <-  y2020 %>% mutate(Month2 = recode(Month, 'Jan','Feb','Mar','Apr',
                                         'May','Jun','Jul','Aug','Sep','Oct',
                                         'Nov','Dec'), ordered = TRUE)

# Create another new column 'DOW' by recoding the 'Day.of.Week' column with an ordered factor.
y2020 <-  y2020 %>% mutate(DOW = recode(Day.of.Week + 1, 'Sun','Mon','Tues',
                                           'Wed','Thurs','Fri', 'Sat'), ordered = TRUE)
# Define the order of months for plotting.
level_order_months <- c('Jan','Feb','Mar','Apr',
                 'May','Jun','Jul','Aug','Sep','Oct',
                 'Nov','Dec')

# Define the order of days of the week for plotting.
level_order_dow <- c('Sun', 'Mon', 'Tues', 'Wed', 'Thurs', 'Fri', 'Sat')

# Bar plot to visualize average 'Trip.Distance' by 'Month2' (months in order) and 'Vehicle.Type'.
ggplot(data = y2020, aes(x = Month2, y = Trip.Distance, fill = Vehicle.Type)) + 
  geom_bar(aes(y = Trip.Distance, x = factor(Month2, levels = level_order_months)), stat = 'summary', fun = mean) + 
  scale_fill_manual(values = c('red','green','blue')) + labs(x = 'Month', y = 'Trip Distance') +
  labs(title = "Average Trip Distance by Month and Vehicle Type") + labs(fill = "Vehicle Type")

# Bar plot to visualize average 'Trip.Distance' by 'DOW' (day of the week) and 'Vehicle.Type'.
ggplot(data = y2020, aes(x = DOW, y = Trip.Distance, fill = Vehicle.Type)) + 
  geom_bar(aes(y = Trip.Distance, x = factor(DOW, levels = level_order_dow)), stat = 'summary', fun = mean) + 
  scale_fill_manual(values = c('red','green','blue')) + labs(x = 'Days of the Week', y = 'Trip Distance') +
  labs(title = "Average Trip Distance by Day of the Week and Vehicle Type") + labs(fill = "Vehicle Type")
```


```{r trip duration and temperature vs. month bar graph}
library(ggplot2)
library(dplyr)

# Data from the original micromobility dataset for the year 2020
y2020 <- Trips2020

# Create a new column 'Month2' by recoding the 'Month' column with an ordered factor.
y2020 <- y2020 %>% mutate(Month2 = recode(Month, 'Jan', 'Feb', 'Mar', 'Apr',
                                        'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct',
                                        'Nov', 'Dec'), ordered = TRUE)

# Define the order of months for plotting.
level_order_months <- c('Jan', 'Feb', 'Mar', 'Apr',
                        'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct',
                        'Nov', 'Dec')

# Temperature data
average_temperature <- c(51.6, 56.3, 60.4, 69.5, 76.7, 82.2, 86.5, 89.9, 77, 71.7, 58.9, 55.8)

# Create a new dataframe with Month and Average_Temperature
temperature_data <- data.frame(Month2 = level_order_months, Average_Temperature = average_temperature)

# Merge the temperature data with the Trips2020 dataset
combined_data <- merge(y2020, temperature_data, by = "Month2")

# Bar plot to visualize average 'Trip Duration' by 'Month2' (months in order), 'Vehicle Type', and 'Average_Temperature'.
ggplot(data = combined_data, aes(x = Month2, y = `Trip Duration`, fill = `Vehicle Type`)) + 
  geom_bar(aes(y = `Trip Duration`, x = factor(Month2, levels = level_order_months)), stat = 'summary', fun = mean, position = "dodge") + 
  geom_line(aes(x = Month2, y = Average_Temperature, group = 1), color = "purple", size = 2, linetype = "dotted") +
  scale_fill_manual(values = c('pink', 'green', 'orange')) + 
  labs(x = 'Month', y = 'Trip Duration') +
  labs(title = "Average Trip Duration by Month, Vehicle Type, and Temperature") + 
  labs(fill = "Vehicle Type") +
  theme(axis.title.y.left = element_text(color = "black")) +
  scale_y_continuous(name = "Trip Duration",
                     breaks = seq(0, max(y2020$`Trip Duration`), by = 10),
                     labels = seq(0, max(y2020$`Trip Duration`), by = 10)) +
  theme(axis.title.y.right = element_text(color = "blue")) +
  scale_y_continuous(
    sec.axis = sec_axis(~ ., name = "Average Temperature", 
                        breaks = seq(0, max(average_temperature), by = 20),
                        labels = seq(0, max(average_temperature), by = 20))
  ) +
  theme_minimal()  # Optionally, you can change the theme
```


```{r trip duration vs. temperature scatterplot}
library(ggplot2)
library(dplyr)

# Data from the original micromobility dataset for the year 2020
y2020 <- Trips2020

# Create a new column 'Month2' by recoding the 'Month' column with an ordered factor.
y2020 <- y2020 %>% mutate(Month2 = recode(Month, 'Jan', 'Feb', 'Mar', 'Apr',
                                        'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct',
                                        'Nov', 'Dec'), ordered = TRUE)

# Define the order of months for plotting.
level_order_months <- c('Jan', 'Feb', 'Mar', 'Apr',
                        'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct',
                        'Nov', 'Dec')

# Temperature data
average_temperature <- c(51.6, 56.3, 60.4, 69.5, 76.7, 82.2, 86.5, 89.9, 77, 71.7, 58.9, 55.8)

# Create a new dataframe with Month and Average_Temperature
temperature_data <- data.frame(Month2 = level_order_months, Average_Temperature = average_temperature)

# Merge the temperature data with the Trips2020 dataset
combined_data <- merge(y2020, temperature_data, by = "Month2")

ggplot(data = combined_data, aes(x = Average_Temperature, y = `Trip Duration`, color = `Vehicle Type`)) +
  geom_point(size = 2) +
  labs(title = "Scatter Plot of Temperature vs. Trip Duration",
       x = "Average Temperature",
       y = "Trip Duration") +
  scale_color_manual(values = c('green', 'red', 'blue'))  # Adjust colors as needed
```





```{r Avg Monthly Precipitation vs Duration and Distance}
library(ggplot2)
library(dplyr)
library(tidyverse)

#change to folder where csv files are located, *change as needed
setwd("...")

## INITIALIZE Y2020 DATA
# read csv files
y2020 <- read.csv('Trips2020.csv')

# Recode 'Month' column with an ordered factor.
y2020 <-  y2020 %>% mutate(Month = recode(Month, 'Jan','Feb','Mar','Apr',
                                           'May','Jun','Jul','Aug','Sep','Oct',
                                           'Nov','Dec'), ordered = TRUE)

# Create another new column 'DOW' by recoding the 'Day.of.Week' column with an ordered factor.
y2020 <-  y2020 %>% mutate(Day.of.Week = recode(Day.of.Week + 1, 'Sun','Mon','Tues',
                                        'Wed','Thurs','Fri', 'Sat'), ordered = TRUE)
# Define the order of months for plotting.
level_order_months <- c('Jan','Feb','Mar','Apr',
                        'May','Jun','Jul','Aug','Sep','Oct',
                        'Nov','Dec')

# Define the order of days of the week for plotting.
level_order_dow <- c('Sun', 'Mon', 'Tues', 'Wed', 'Thurs', 'Fri', 'Sat')

## INITIALIZE PRECIPITATION DATA
# select only 2020 data from csv
precip2020 <- read.csv('Precipitation_19-21.csv') %>% slice(2)

# tidy data to fit y2020 data
precip2020 <- precip2020 %>% pivot_longer(c('January', 'February', 'March',
                                     'April', 'May', 'June', 'July',
                                     'August', 'September', 'October',
                                     'November', 'December'),
                                   names_to = 'Month', values_to = 'Precipitation')

# change month name to fit y2020 data
rep_str <- c('January' = 'Jan', 'February' ='Feb', 'March' = 'Mar',
             'April' = 'Apr', 'May' = 'May', 'June' = 'Jun', 'July'= 'Jul',
             'August' = 'Aug', 'September' ='Sep', 'October' ='Oct',
             'November' = 'Nov', 'December' = 'Dec')
precip2020$Month <- str_replace_all(precip2020$Month, rep_str)

# Join precip data to y2020
y2020 <- y2020 %>% full_join(precip2020, relationship = 'many-to-many')

#Convert duration from seconds to minutes
y2020$Trip.Duration = y2020$Trip.Duration/60

##Create 2 adjacent bar graphs with two y axes and month as x axis. Duration vs Precipitation
#initial plot data based on precipitation
ggplot(data = y2020, aes(x = Month, y = Precipitation)) +
  #create second axis: trip duration
  scale_y_continuous(name = 'Inches', limits = c(0,8), sec.axis = sec_axis( ~. , name = 'Minutes')) +
  #create 1st bar graph for month and precipitation
  geom_bar(alpha = 1, aes(x = factor(Month, level_order_months), y = Precipitation, fill = 'blue'), position = position_nudge(x = -0.15), 
           width = 0.3, stat = 'summary', fun = 'mean') +
  #create 2nd bar graph for month and trip duration
  geom_bar(alpha = 1, aes(x = factor(Month, level_order_months), y = Trip.Duration, fill = 'red'), position = position_nudge(x = 0.15), 
           width = 0.3, stat = 'summary') +
  labs(title = 'Average Trip Duration in Relation to Average Monthly Precipitation') + 
  scale_fill_manual(name = 'Variable', values =c('blue'='blue','red'='red'), guide = 'legend', labels = c('Precipitation','Duration'))

#Same as above just change Duration to Distance
ggplot(data = y2020, aes(x = Month, y = Precipitation)) +
  #create second axis: trip duration
  scale_y_continuous(name = 'Inches', limits = c(0,8), sec.axis = sec_axis( ~.*100 , name = 'Meters')) +
  #create 1st bar graph for month and precipitation
  geom_bar(alpha = 1, aes(x = factor(Month, level_order_months), y = Precipitation, fill = 'blue'), position = position_nudge(x = -0.15), 
           width = 0.3, stat = 'summary', fun = 'mean') +
  #create 2nd bar graph for month and trip distance
  geom_bar(alpha = 1, aes(x = factor(Month, level_order_months), y = Trip.Distance/100, fill = 'red'), position = position_nudge(x = 0.15), 
           width = 0.3, stat = 'summary') +
  labs(title = 'Average Trip Distance in Relation to Average Monthly Precipitation') +
  scale_fill_manual(name = 'Variable', values =c('blue'='blue','red'='red'), guide = 'legend', labels = c('Precipitation','Distance'))
```

```{r vehicle type vs. duration}
# Load required libraries
library(ggplot2)
library(ggridges)
library(dplyr)

# Import trip data for the year 2020
Trips2020 <- read.csv('SharedMicromobilityVehicleTrips.csv')

ggplot(Trips2020, aes(x = Trip.Duration, y = Vehicle.Type, fill = Vehicle.Type)) +
  geom_density_ridges() +
  theme_ridges() +
  labs(x = "Trip Duration (s)", y = "Vehicle Type") +
  scale_fill_brewer(palette = "Set1") +  
  ggtitle("Ridgeline Plot of Trip Duration by Vehicle Type") + 
  xlim(0, 2217.5) #Above 2217.5 is outliers

ggplot(Trips2020, aes(x = Trip.Distance, y = Vehicle.Type, fill = Vehicle.Type)) +
  geom_density_ridges() +
  theme_ridges() +
  labs(x = "Trip Distance (m)", y = "Vehicle Type") +
  scale_fill_brewer(palette = "Set1") +  
  ggtitle("Ridgeline Plot of Trip Distance by Vehicle Type") + 
  xlim(0, 5451.5) #Above 5451.5 is outliers
```

=======
